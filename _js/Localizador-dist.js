"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e}}(),INITIAL_UI_STATE={uf:"",cidade:"",loja:null},INITIAL_LOJAS_STATE=LISTA_LOJAS,INITIAL_BOLSOES_STATE=LISTA_BOLSOES,INITIAL_OFERTAS_STATE=LISTA_OFERTAS,_setLoja=function(e,t){return{type:"SET_LOJA",loja:e}},lojasReducer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:INITIAL_LOJAS_STATE;arguments[1];return e},ofertasReducer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:INITIAL_OFERTAS_STATE;arguments[1];return e},uiReducer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:INITIAL_UI_STATE,t=arguments[1];switch(t.type){case"SET_LOJA":return $.extend({},e,{loja:t.loja});default:return e}},bolsoesReducer=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:INITIAL_BOLSOES_STATE;arguments[1];return e},APP_REDUCER=Redux.combineReducers({bolsoes:bolsoesReducer,lojas:lojasReducer,ofertas:ofertasReducer,ui:uiReducer}),Modal=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.content;return t?React.createElement("div",{class:"modal-localizador",style:{maxHeight:$(window).height()}},React.createElement("div",{class:"modal-localizador__wrapper"},React.createElement("div",{class:"modal-localizador__box"},React.createElement("div",{class:"modal-localizador__box--inner"},React.createElement("button",{onClick:this.props.closeModal,class:"modal-localizador__close"},"X"),React.createElement("div",{class:"modal-localizador__content"},a))))):null}}]),t}(),StoreCardClass=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={showingOffers:!1},t}return _inherits(a,React.Component),_createClass(a,[{key:"getStoreDescription",value:function(e){switch(e){case"market":return"Mercearia seca e molhada; açougue; bebidas; rotisseria; padaria; verduras, frutas e legumes; higiene e limpeza.";case"express":return"Mercearia; bebidas; snacks; pães; frutas, verduras e legumes; itens prontos para o consumo; produtos de higiene.";case"bairro":return"Mercearia completa; açougue; feira; bebidas; perfumaria; padaria; itens de higiene, limpeza e pet care. ";case"posto":return"Combustíveis diversos; fluídos e óleos lubrificantes; produtos para cuidar do seu carro ou moto.";case"drogaria":return"Medicamentos diversos; genéricos; cosméticos; descontos para cadastrados nos programas dos laboratórios.";case"hiper":default:return"Mercearia completa; açougue; feira; padaria; bebidas; perfumaria; moda; eletro; itens para casa, carro e pet."}}},{key:"getTodayTimestamp",value:function(){return+new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())}},{key:"fixedTimestamp",value:function(e){var t=new Date(e);return t.setDate(t.getDate()-1),+new Date(t.getFullYear(),t.getMonth(),t.getDate())}},{key:"isValidOffer",value:function(e){var t=this.getTodayTimestamp();return t>=e.inicio&&t<=e.final}},{key:"titleCase",value:function(e){return e.split(" ").map(function(e){return e.substr(0,1).toUpperCase()+e.substr(1,e.length).toLowerCase()}).join(" ")}},{key:"hasOffers",value:function(a){var e=this,r=!1,t=this.props,o=t.ofertas,n=t.bolsoes,s=[];return 0===o.length?r:(o.map(function(t){if(!e.isValidOffer(t))return!1;t.bolsoes.map(function(e){n[e]&&0<=t.bolsoes.indexOf(e)&&0<=n[e].lojas.indexOf(a.id)&&t.tipo.includes(a.tipo)&&(s.push({bolsao:n[e].bolsao,oferta:t}),r=!0)})}),this.props.offersToShow=s,r?s:[])}},{key:"getOfferUrl",value:function(e){return"https://www.carrefour.com.br/tabloide-digital?paginas="+e.oferta.paginas+"&bolsao="+e.bolsao+"&os="+e.oferta.os+"&width="+e.oferta.size.width+"&height="+e.oferta.size.height}},{key:"createModalContent",value:function(){var t=this;return React.createElement("div",null,React.createElement("p",{class:"txt-center"},"Escolha qual folheto deseja visualizar:"),React.createElement("ul",{class:"offer__list"},this.props.offersToShow.map(function(e){return React.createElement("li",{class:"offer__item"},React.createElement("a",{class:"bt bt-wide bt-theme--1",href:t.getOfferUrl(e),target:"_blank"},e.oferta.nome))})))}},{key:"render",value:function(){var t=this,e=this.props.loja,a=this.hasOffers(e);return React.createElement("div",{class:"store-card "+e.tipo},React.createElement("div",null,React.createElement("h3",{class:"store-card__title"},e.loja.replace("Carrefour","").trim()),React.createElement("p",{class:"store-card__text"},this.titleCase(e.logradouro),", ",e.numero,e.complemento?" - "+e.complemento:"",React.createElement("br",null),e.bairro?e.bairro+" ":"",React.createElement("br",null),e.cidade," - ",e.uf,React.createElement("br",null),"CEP: ",e.cep,React.createElement("br",null)),React.createElement("div",{class:"store-card__bt-container"},a.length?1<a.length?React.createElement("button",{class:"bt bt-theme--4",onClick:function(){return t.props.openModal(t.createModalContent())}},"Ver folhetos de ofertas"):React.createElement("a",{href:this.getOfferUrl(a[0]),target:"_blank",class:"bt bt-theme--4"},"Ver folheto de ofertas"):"",React.createElement("a",{class:"bt bt-theme--5 mb0",href:"https://maps.google.com/?q="+e.logradouro+", "+e.numero,target:"_blank"},"Ver mapa")),this.state.showingOffers&&React.createElement("ul",{class:"offer__list"},this.props.offersToShow.map(function(e){return React.createElement("li",{class:"offer__item"},React.createElement("a",{class:"offer__link",href:t.getOfferUrl(e),target:"_blank"},e.oferta.nome))})),React.createElement("p",{class:"store-card__text store-card__text--description"},this.getStoreDescription(e.tipo))))}}]),a}(),StoreCardClass_mapStateToProps=function(e){return{bolsoes:e.bolsoes,ofertas:e.ofertas,offersToShow:[]}},StoreCard=ReactRedux.connect(StoreCardClass_mapStateToProps)(StoreCardClass),OfferCardClass=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"titleCase",value:function(e){return e.split(" ").map(function(e){return e.substr(0,1).toUpperCase()+e.substr(1,e.length).toLowerCase()}).join(" ")}},{key:"_addDecimal",value:function(e){return e<10?"0"+e:""+e}},{key:"getFormattedDate",value:function(e){return this._addDecimal(new Date(e).getDate())+"/"+this._addDecimal(new Date(e).getMonth()+1)}},{key:"render",value:function(){var e=this.props,t=e.loja,a=e.offer;return React.createElement("div",{class:"store-card offer-card"},React.createElement("img",{class:"offer-card--store",src:"https://static.carrefour.com.br/imagens/localizador/_img/logo_"+t.tipo+".png"}),React.createElement("figure",{class:"offer-card--cover lazy-load--container"},React.createElement("a",{href:"https://www.carrefour.com.br/tabloide-digital?paginas="+a.oferta.paginas+"&bolsao="+a.bolsao+"&os="+a.oferta.os+"&width="+a.oferta.size.width+"&height="+a.oferta.size.height,target:"_blank"},React.createElement("img",{class:"lazy-load","data-src":"https://static.carrefour.com.br/imagens/tabloide-digital/v1/_img/impressos/"+a.oferta.os+"/01_"+a.bolsao+"_"+a.oferta.os+".jpg"}))),React.createElement("p",{class:"offer-card--date"},"válido de ",React.createElement("strong",null,this.getFormattedDate(a.oferta.inicio))," a ",React.createElement("strong",null,this.getFormattedDate(a.oferta.final))),React.createElement("h3",{class:"store-card__title"},t.loja.replace("Carrefour","").trim()," -",React.createElement("br",null),a.oferta.nome),React.createElement("p",{class:"store-card__text"},this.titleCase(t.logradouro),", ",t.numero,t.complemento?" - "+t.complemento:"",React.createElement("br",null),t.bairro?t.bairro+" ":"",React.createElement("br",null),t.cidade," - ",t.uf,React.createElement("br",null),"CEP: ",t.cep,React.createElement("br",null)))}}]),t}(),OfferCardClass_mapStateToProps=function(e){return{bolsoes:e.bolsoes,ofertas:e.ofertas}},OfferCard=ReactRedux.connect(OfferCardClass_mapStateToProps)(OfferCardClass),StoreListClass=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={lojas:e.lojas},t}return _inherits(a,React.Component),_createClass(a,[{key:"componentDidMount",value:function(){var u=this,a=this,d=this.props.lojas;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(e){for(var t,a,r,o,n,s,i=e.coords.latitude,l=e.coords.longitude,c=0;c<d.length;c++)d[c].distancia=(t=d[c],s=o=void 0,a=Math.PI*i/180,r=Math.PI*t.lat/180,Math.PI,Math.PI,t.lng,o=l-t.lng,n=Math.PI*o/180,s=Math.sin(a)*Math.sin(r)+Math.cos(a)*Math.cos(r)*Math.cos(n),s=60*(s=180*(s=Math.acos(s))/Math.PI)*1.1515,s*=1.609344);d.sort(function(e,t){return e.distancia-t.distancia}),u.setState({lojas:d})},console.warn("geolocation disabled"))}$(window).scroll(function(){$("img.lazy-load").each(function(){var e=this;if(a.isScrolledIntoView($(this))){var t=new Image;t.onload=function(){$(e).attr("src",$(e).attr("data-src")),$(e).css("opacity","1")},t.src=$(this).attr("data-src")}})}),setTimeout(function(){return $(window).trigger("scroll")},100)}},{key:"isScrolledIntoView",value:function(e){var t=$(window).scrollTop(),a=t+$(window).height(),r=$(e).offset().top;return r+$(e).height()/2<=a&&t<=r}},{key:"getTodayTimestamp",value:function(){return+new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate())}},{key:"fixedTimestamp",value:function(e){var t=new Date(e);return t.setDate(t.getDate()-1),+new Date(t.getFullYear(),t.getMonth(),t.getDate())}},{key:"isValidOffer",value:function(e){var t=this.getTodayTimestamp();return t>=this.fixedTimestamp(e.inicio)&&t<=e.final}},{key:"hasOffers",value:function(a){var e=this,r=!1,t=this.props,o=t.ofertas,n=t.bolsoes,s=[];return 0===o.length?r:(o.map(function(t){if(!e.isValidOffer(t))return!1;t.bolsoes.map(function(e){n[e]&&0<=t.bolsoes.indexOf(e)&&0<=n[e].lojas.indexOf(a.id)&&t.tipo.includes(a.tipo)&&(s.push({bolsao:n[e].bolsao,oferta:t}),r=!0)})}),this.props.offersToShow=s,r?s:[])}},{key:"render",value:function(){var t=this,a=this,e=this.state.lojas,r=this.props.applyFilter,o=0;this.props.isOffer&&e.filter(r).map(function(e){return o+=t.hasOffers(e).length});var n=e.filter(r).length,s=this.props.isOffer?o:n;return setTimeout(function(){return $(window).trigger("scroll")},100),React.createElement("section",{class:"store-list"},React.createElement("h2",{class:"store-list__count txt-center"},React.createElement("div",null,React.createElement("strong",null,s||""),s?this.props.isOffer?1===s?" folheto encontrado":" folhetos encontrados":1===s?" loja encontrada":" lojas encontradas":this.props.isOffer?"Nenhum folheto encontrado.":"Nenhuma loja encontrada.")),n&&React.createElement("div",null,this.props.isOffer?e.filter(r).map(function(t){var e=a.hasOffers(t);if(e.length)return React.createElement("span",null,e.map(function(e){return React.createElement(OfferCard,{loja:t,offer:e})}))}):e.filter(r).map(function(e){return React.createElement(StoreCard,{openModal:t.props.openModal,loja:e})})))}}]),a}(),StoreList_mapStateToProps=function(e){var t=e.lojas;return{bolsoes:e.bolsoes,ofertas:e.ofertas,lojas:t.map(function(e){return Object.assign(e,{distancia:null})})}},StoreList=ReactRedux.connect(StoreList_mapStateToProps)(StoreListClass),FormClass=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={currentBusca:"",currentOrigem:"",currentDestino:"",comoChegar:!1,isFilterOn:!1,storeFound:!1,lojas:[]},t.formSubmitHandler=t.formSubmitHandler.bind(t),t.buscaChangeHandler=t.buscaChangeHandler.bind(t),t.partidaChangeHandler=t.partidaChangeHandler.bind(t),t.destinoChangeHandler=t.destinoChangeHandler.bind(t),t.toggleFilters=t.toggleFilters.bind(t),t.criaRota=t.criaRota.bind(t),t.directionCallback=t.directionCallback.bind(t),t.limpaBusca=t.limpaBusca.bind(t),t.submitPartida=t.submitPartida.bind(t),t}return _inherits(a,React.Component),_createClass(a,[{key:"listAllUf",value:function(e){var a=[];return e.map(function(e){var t=e.uf.toUpperCase().trim();-1===a.indexOf(t)&&a.push(t)}),a.splice(a.indexOf("SP"),1),["SP"].concat(a.sort())}},{key:"lojaChangeHandler",value:function(e){var t=e.target.value;this.setState({currentLoja:t})}},{key:"buscaChangeHandler",value:function(e){var t=e.target.value;this.setState({currentBusca:t})}},{key:"partidaChangeHandler",value:function(e){var t=e.target.value;$("#cmpPartida").removeClass("erro"),this.setState({currentOrigem:t})}},{key:"destinoChangeHandler",value:function(e){var t=e.target.value;this.setState({currentDestino:t})}},{key:"formSubmitHandler",value:function(e){if(e.preventDefault(),$("#cmpBusca").removeClass("erro"),!this.state.currentBusca.length)return $("#cmpBusca").addClass("erro"),!1}},{key:"limpaBusca",value:function(){this.setState({currentDestino:"",storeFound:!1})}},{key:"listAllStores",value:function(t){return this.props.lojas.filter(function(e){return e.cidade.toUpperCase()===t})}},{key:"toggleFilters",value:function(){this.setState({isFilterOn:!this.state.isFilterOn})}},{key:"filterContains",value:function(e){return 0<=this.state.filtros.indexOf(e)}},{key:"criaRota",value:function(){if($("#cmpPartida").removeClass("erro"),this.state.currentOrigem.length<1)return $("#cmpPartida").addClass("erro"),!1;this.state.currentOrigem,this.state.currentDestino}},{key:"submitPartida",value:function(e){"Enter"===e.key&&(e.preventDefault(),this.criaRota())}},{key:"directionCallback",value:function(e,t){}},{key:"toggleFiltersUI",value:function(){$(".localizador__ui").toggleClass("isOpen")}},{key:"componentWillReceiveProps",value:function(e){this.setState({currentDestino:e.ui.loja})}},{key:"render",value:function(){var t=this;this.props.scrollToTop(),this.props.uf=this.listAllUf(this.props.lojas);var e=this.state.currentDestino,a=this.props;a.lojas,a.applyFilter;return React.createElement("article",{class:"localizador__ui "+(this.props.isOffer?"localizador__ui--offer":"")},!e&&React.createElement(MainHeader,{isOffer:this.props.isOffer}),React.createElement("div",{class:"filter-header"},React.createElement("button",{class:"filter-header__button bt-theme--4",onClick:this.toggleFiltersUI},"Selecionar região e tipo de loja")),React.createElement("form",{class:"localizador__form vertical",onSubmit:this.formSubmitHandler},!e&&React.createElement("div",null,React.createElement("p",{class:"localizador__ui__filter--header"},React.createElement("span",null,"1. Escolha o Estado, Cidade e Bairro:")),React.createElement("div",{class:"localizador__form--double-select"},React.createElement("select",{id:"cmpUf",name:"cmpUf",onChange:this.props.ufChangeHandler,value:this.state.currentUf},React.createElement("option",{value:""},"Estado"),this.props.uf.map(function(e){return React.createElement("option",{value:e},e)})),React.createElement("select",{id:"cmpCidade",name:"cmpCidade",onChange:this.props.cidadeChangeHandler,value:this.state.currentCidade},React.createElement("option",{value:""},"Cidade"),this.props.cidades.map(function(e){return React.createElement("option",{value:e},e)}))),this.props.currentCidade&&1<this.props.bairros.length&&React.createElement("div",null,React.createElement("select",{id:"cmpBairro",name:"cmpBairro",class:"localizador__form--large-select mb0",onChange:this.props.bairroChangeHandler,value:this.state.currentBairro},React.createElement("option",{value:""},"Bairro"),this.props.bairros.map(function(e){return React.createElement("option",{value:e},e)})))),this.state.currentDestino&&React.createElement("div",null,React.createElement("button",{class:"uppercase font-small mb10 bt-theme--1",onClick:this.limpaBusca},"Voltar"),React.createElement("div",null,this.state.storeFound&&React.createElement("p",{class:"info-window__text info-window__text--resultado"},"Loja mais próxima encontrada:"),React.createElement("h3",{class:"info-window__title"},e.loja),React.createElement("p",{class:"info-window__text"},e.logradouro,", ",e.numero,e.complemento?" - "+e.complemento:"",React.createElement("br",null),e.bairro?e.bairro+", ":"",e.cidade," - ",e.uf,React.createElement("br",null),"CEP: ",e.cep,React.createElement("br",null)),React.createElement("p",{class:"info-window__text--description"},"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolores, dolor."),React.createElement("div",{class:"info-window__double-button"},React.createElement("button",{class:"bt-theme--1 info-window__button",type:"button",onClick:""},"Ver ofertas"),React.createElement("button",{class:"bt-theme--2 info-window__button",type:"button",onClick:function(){return t.setState({comoChegar:!t.state.comoChegar,currentOrigem:t.state.currentBusca.length?t.state.currentBusca:""})}},"Como Chegar"))),this.state.comoChegar&&React.createElement("div",{class:"localizador__form--rota"},React.createElement("input",{type:"text",id:"cmpPartida",name:"cmpPartida",placeholder:"Seu ponto de partida",onChange:this.partidaChangeHandler,onKeyPress:this.submitPartida,value:this.state.currentOrigem}),React.createElement("input",{type:"text",id:"cmpDestino",name:"cmpDestino",placeholder:"Seu destino",value:this.state.currentDestino.logradouro+", "+this.state.currentDestino.numero+" - "+this.state.currentDestino.cidade,readonly:"readonly"}),React.createElement("button",{type:"button",class:"bt-theme--3 bt-wide",onClick:this.criaRota},"Ver rota")))),React.createElement("div",{class:"localizador__ui__filter vertical"},React.createElement("div",null,React.createElement("p",{class:"localizador__ui__filter--header"},React.createElement("span",null,"2. Escolha um ou mais tipos de loja que deseja visualizar:")),React.createElement("div",{class:"localizador__ui__filtros"},React.createElement("ul",null,this.props.categorias.map(function(e){return React.createElement("li",{class:"localizador__ui__filtro "+e},React.createElement("label",{for:"filtro_"+e},e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()),React.createElement("span",{class:"localizador__ui__checkbox"},React.createElement("input",{type:"checkbox",checked:!(t.props.filtros.indexOf(e)<0),id:"filtro_"+e,name:"filtro_"+e,onChange:function(){return t.props.filtrosChangeHandler(e)}}),React.createElement("span",{class:"localizador__ui__checkbox--check"})))}))))))}}]),a}(),FormClass_mapStateToProps=function(e){var a=e.bolsoes,r=e.lojas,t=e.ui,o=e.ofertas,n=[];if(r=r.map(function(e){return-1===n.indexOf(e.tipo)&&n.push(e.tipo),e.bolsoes=[],e}),0<=n.indexOf("hiper")&&"hiper"!==n[0]){var s=n[0],i=n.indexOf("hiper");n[0]=n[i],n[i]=s}if(0<=n.indexOf("express")&&"express"!==n[1]){var l=n[1],c=n.indexOf("express");n[1]=n[c],n[c]=l}for(var u in a)a[u].lojas.map(function(t){r.forEach(function(e){e.id===t.sigla&&e.bolsoes.push(a[u].bolsao)})});return{bolsoes:a,lojas:r,ui:t,categorias:n,ofertas:o}},Form=ReactRedux.connect(FormClass_mapStateToProps)(FormClass),MapClass=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.map=e.map,t}return _inherits(a,React.Component),_createClass(a,[{key:"componentWillReceiveProps",value:function(e){$(".localizador, .localizador__mapa, .mapa").height(e.height)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.lojas,a=e.ofertas;e.height;window.gmap=new GMap(t,a,this.props)}},{key:"render",value:function(){this.props.lojas;return React.createElement("div",{class:"localizador__mapa"},React.createElement("div",{id:"map",class:"mapa"}))}}]),a}(),MapClass_mapStateToProps=function(e){return{lojas:e.lojas,ofertas:{}}},Mapa=ReactRedux.connect(MapClass_mapStateToProps)(MapClass),MainHeaderClass=function(e){function t(e){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement("div",{class:"localizador__header vertical"},React.createElement("h1",{class:"localizador__header--title"},this.props.isOffer?"Confira o folheto de ofertas da loja mais próxima.":"Encontre aqui o Carrefour mais próximo de você."),!this.props.isOffer&&React.createElement("p",{class:"localizador__header--subtitle"},"Ao localizar uma loja, você também pode conferir as ofertas disponíveis."))}}]),t}(),MainHeader=ReactRedux.connect()(MainHeaderClass),AppClass=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.state={currentUf:"",currentCidade:"",currentBairro:"",currentLoja:"",height:600,cidades:[],bairros:[],filtros:["hiper"],modalVisible:!1,modalContent:""},t.setHeight=t.setHeight.bind(t),t.setDestination=t.setDestination.bind(t),t.ufChangeHandler=t.ufChangeHandler.bind(t),t.cidadeChangeHandler=t.cidadeChangeHandler.bind(t),t.bairroChangeHandler=t.bairroChangeHandler.bind(t),t.lojaChangeHandler=t.lojaChangeHandler.bind(t),t.filtrosChangeHandler=t.filtrosChangeHandler.bind(t),t.applyFilter=t.applyFilter.bind(t),t.closeModal=t.closeModal.bind(t),t.openModal=t.openModal.bind(t),t}return _inherits(a,React.Component),_createClass(a,[{key:"componentDidMount",value:function(){var t=this;this.setHeight(),$(window).resize(function(e){t.setHeight(),$(window).trigger("scroll")}),$(window).scroll(function(){$(".localizador__ui").removeClass("isOpen"),t.toggleFixedHeader(),t.toggleScrollButton()}),$(window).trigger("scroll")}},{key:"setHeight",value:function(){var e=$(window).height();$(window).width()<768&&(e="auto"),this.setState({height:e})}},{key:"setDestination",value:function(e){this.props.setLoja(e)}},{key:"shouldFixTop",value:function(){var e=!1,t=$(window).scrollTop(),a=$(window).width();return 1100<=a&&170<t?e=!0:660<=a&&140<t?e=!0:a<660&&110<t&&(e=!0),e}},{key:"toggleFixedHeader",value:function(){this.shouldFixTop()?$("#app .localizador").addClass("topFixed"):$("#app .localizador").removeClass("topFixed")}},{key:"toggleScrollButton",value:function(){this.checkScroll()?$(".localizador__scroll-top").fadeIn("fast"):$(".localizador__scroll-top").fadeOut("fast")}},{key:"checkScroll",value:function(){var e=!1;return $(window).width()<=680?215<=$(window).scrollTop()&&(e=!0):$(window).scrollTop()>=$(window).height()&&(e=!0),e}},{key:"ufChangeHandler",value:function(e){var t=e.target.value,a=this.listAllCities(t);this.setState({currentUf:t,currentCidade:"",cidades:a})}},{key:"cidadeChangeHandler",value:function(e){var t=e.target.value,a=this.listAllDistricts(t);this.setState({currentCidade:t,bairros:a})}},{key:"bairroChangeHandler",value:function(e){var t=e.target.value;this.setState({currentBairro:t})}},{key:"lojaChangeHandler",value:function(e){var t=e.target.value;this.setState({currentLoja:t})}},{key:"filtrosChangeHandler",value:function(e){var t=[].concat(this.state.filtros),a=t.indexOf(e);-1===a?t.push(e):t.splice(a,1),this.setState({filtros:t})}},{key:"listAllCities",value:function(a){var r=[];return this.props.lojas.map(function(e){if(!e.uf||!e.cidade)return!1;if(e.uf.toUpperCase().trim()!==a)return!1;var t=e.cidade.toUpperCase().trim();-1===r.indexOf(t)&&r.push(t)}),"SP"===a?(r.splice(r.indexOf("SÃO PAULO"),1),["SÃO PAULO"].concat(r.sort())):r.sort()}},{key:"listAllDistricts",value:function(a){var r=[];return this.props.lojas.map(function(e){if(!e.uf||!e.cidade||!e.bairro)return!1;if(e.cidade.toUpperCase().trim()!==a)return!1;var t=e.bairro.toUpperCase().trim();-1===r.indexOf(t)&&r.push(t)}),r.sort()}},{key:"applyFilter",value:function(e){var t=this.state;return(!t.currentUf||t.currentUf.toUpperCase()===e.uf.toUpperCase())&&((!t.currentCidade||t.currentCidade.toUpperCase()===e.cidade.toUpperCase())&&((!t.currentBairro||t.currentBairro.toUpperCase()===e.bairro.toUpperCase())&&-1!==t.filtros.indexOf(e.tipo)))}},{key:"scrollToTop",value:function(){$("html, body").animate({scrollTop:0},500)}},{key:"openModal",value:function(e){this.setState({modalVisible:!0,modalContent:e})}},{key:"closeModal",value:function(){this.setState({modalVisible:!1,modalContent:""})}},{key:"render",value:function(){var e=this.state,t=e.currentUf,a=e.currentCidade,r=e.currentBairro,o=e.cidades,n=e.bairros,s=e.filtros;return React.createElement("div",{class:"localizador"},React.createElement(Form,{cidades:o,bairros:n,filtros:s,currentCidade:a,currentBairro:r,ufChangeHandler:this.ufChangeHandler,cidadeChangeHandler:this.cidadeChangeHandler,bairroChangeHandler:this.bairroChangeHandler,filtrosChangeHandler:this.filtrosChangeHandler,applyFilter:this.applyFilter,scrollToTop:this.scrollToTop,isOffer:this.props.isOffer}),React.createElement(StoreList,{applyFilter:this.applyFilter,filters:{currentUf:t,currentCidade:a,currentBairro:r,filtros:s},openModal:this.openModal,isOffer:this.props.isOffer}),React.createElement(Modal,{visible:this.state.modalVisible,content:this.state.modalContent,closeModal:this.closeModal}),React.createElement("button",{class:"localizador__scroll-top",onClick:this.scrollToTop,type:"button"},"Voltar para o topo"))}}]),a}(),AppClass_mapStateToProps=function(e){return{ui:e.ui,map:{},lojas:e.lojas}},AppClass_mapDispatchToProps=function(t){return{setLoja:function(e){return t(_setLoja(e))}}},App=ReactRedux.connect(AppClass_mapStateToProps,AppClass_mapDispatchToProps)(AppClass),store=Redux.createStore(APP_REDUCER),version=2911.1,isOffer=!1;ReactDOM.render(React.createElement(ReactRedux.Provider,{store:store},React.createElement(App,{isOffer:isOffer})),document.querySelector("#app"));